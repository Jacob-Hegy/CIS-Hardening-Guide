I like to think of the relationship between user rights and security controls in a bit of an odd way.

Imagine you had a gun in a box. You can reinforce that box as much as you want. You can make it steel, you can surround it with barbed wire, you can drop it to the bottom of the ocean, but if the box is opened then the gun is accessible and useable.

However, imagine that gun had a fingerprint scanner on it. Or what if the gun has no ammo? You could remove the trigger, lock the hammer open, any degree of things you wish to do as long as it still serves the purpose that *you* have for it.

In this hypothetical, the box is the security controls and all the add-ons to the gun are the user rights. The security controls inhibit the attacker's efforts while controlling user rights limits their capabilities should they get in. Or in the case of an insider threat, it prevents that threat from creating a large impact when given access to the dangerous equipment/data/network/etc.

That, to me, is the nature of user rights and why they are so critical when it comes to security. It's not all life or death type stuff, it can be insignificant too. Like maybe you just don't want your employees playing Pac-man on the job, or you'd like them to avoid causing disruptions in the network by trying to fix something themselves. It limits the risk that any given user creates by existing.

| Policy | Benefits | Potential Inhibitors | Level of Applicability | Privilege Path in Group Policy Management Editor |
| ---- | ---- | ---- | ---- | ---- |
| 2.2.1 Ensure 'Access Credential Manager as a trusted caller' is set to 'No One' | Restricts access to credentials used by the system | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Access Credential Manager as a trusted caller |
| 2.2.2 Ensure 'Access this computer from the network' is set to 'Administrators, Remote Desktop Users' | Enables the usage of protocols like SMB, NetBIOS, Common Internet File System (CIFS), and Component Object Model Plus (COM+) + enables users access to network resources like printers and servers | Can completely block access to network resources if improperly configured (if a resource must be accessed by certain people, grant specific groups permissions for access) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Access this computer from the network |
| 2.2.3 Ensure 'Act as part of the operating system' is set to 'No One' | Prevents kernel level access to the computer, impeding the destruction of evidence and attempts at tampering with the system | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Act as part of the operating system |
| 2.2.4 Ensure 'Adjust memory quotas for a process' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE' | Prevents accidental resource exhaustion or malicious manipulation to perform a DoS attack | Potential additional accounts necessary for processes running on the system such as ASP.NET or IIS | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Adjust memory quotas for a process |
| 2.2.5 Ensure 'Allow log on locally' is set to 'Administrators, Users' | Prevents unauthorized access to systems, thus thwarting potential attempts at exfiltration, espionage, tampering, the installation of malware, etc. | Potentially disrupt users with specific admin roles that need access (ex. helpdesk) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Allow log on locall |
| 2.2.6 Ensure 'Allow log on through Remote Desktop Services' is set to 'Administrators, Remote Desktop Users' | Whitelists users who should have remote access, thus ensuring that only those with necessary responsibilities can use resources without physical access | Potentially disrupt users with specific admin roles that need access (ex. helpdesk) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Allow log on through Remote Desktop Services |
| 2.2.7 Ensure 'Back up files and directories' is set to 'Administrators' | Prevents the exfiltration of backups performed by unauthorized end users who could use said backups on a foreign workstation to view sensitive data | Potentially disrupt users with specific admin roles that need access (ex. backup administrators) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Back up files and directories |
| 2.2.8 Ensure 'Change the system time' is set to 'Administrators, LOCAL SERVICE' | Prevents issues involving timestamps on logs not lining up, issues with GPOs from the Domain Controllers, and the ability of Kerberos to distribute tickets | Virtually zero impact because time synchronization is already a normal thing on devices | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Change the system time |
| 2.2.9 Ensure 'Change the time zone' is set to 'Administrators, LOCAL SERVICE, Users' | Allows user to synchronize their computer with Domain Controllers in different time zones | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Change the time zone |
| 2.2.10 Ensure 'Create a pagefile' is set to 'Administrators' | A pagefile is a reserved portion of storage that RAM can use to store data that hasn't been recently used<br><br>Prevents users from altering a pagefile's size in a way that could potentially impact the system's performance | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create a pagefile |
| 2.2.11 Ensure 'Create a token object' is set to 'No One' | Access tokens are generated upon user authentication and are used to keep track of the user's privileges<br><br>Prevents the malicious creation of fake access tokens/modification of existing ones that could provide an attack vector for privilege escalation or a DoS attack | N/A (any non-admin user has no reason to be messing with access tokens) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create a token object |
| 2.2.12 Ensure 'Create global objects' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE' | Global objects are objects that can be used by processes regardless of the currently logged in user (important for Remote Desktop Services<br><br>Prevents users from creating global objects that influence other user/system accounts causing app failure, data corruption, or elevation of privilege | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create global objects |
| 2.2.13 Ensure 'Create permanent shared objects' is set to 'No One' | Limits the usage of this right to components running in kernel mode, which already inherently are permitted the creation of permanent shared objects. This prevents possible data exposure | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create permanent shared objects |
| 2.2.14 Configure 'Create symbolic links' | Preventing the creation of pointers to other objects within the file system that create the risk of files having their perms altered, corrupting/destroying data, or enabling a DoS attack<br><br>NOTE: By default, only Admins should have this perm, but on systems running Hyper-V also grant this perm to NT VIRTUAL MACHINE\Virtual Machines | Potentially prevent the creation of virtual machines on systems running Hyper-V if the perm is improperly configured | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create symbolic links |
| 2.2.15 Ensure 'Debug programs' is set to 'Administrators' | Prevents access to sensitive data being used by system processes and the OS, such as password hashes + thwarts possible modification to kernel level applications that could result in rootkit injection | Potential roadblock in debugging a server running a buggy process, but this can be solved by moving the server to a new OU temporarily and granting it the right to debug programs | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Debug programs |
| 2.2.16 Ensure 'Deny access to this computer from the network' to include 'Guests' | Prevents the enumeration of information over the network such as resources, account names, and group names + protects against data exposure or modification by unauthorized and unknown parties | Could potentially inhibit access for authorized individuals performing administrative or custodial tasks within the network | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny access to this computer from the network |
| 2.2.17 Ensure 'Deny log on as a batch job' to include 'Guests' | Prevents the usage of unauthorized accounts to commence DoS attacks on the network | Could prevent users with administrative responsibilities from configuring tasks with the Task Scheduler | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on as a batch job |
| 2.2.18 Ensure 'Deny log on as a service' to include 'Guests' | Prevent unauthorized users from configuring and running unauthorized tasks, such as malware (already mostly prevented via properly permissions for running services, but still worth configuring) | Potential DoS situation on server if improper rights are specified as services won't start | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on as a service |
| 2.2.19 Ensure 'Deny log on locally' to include 'Guests' | Anonymous logins make it difficult to log activity as well as ensure proper rights are granted to specific users<br><br>Disabling unauthorized (guest) accounts prevents this issue from presenting | If used as a user right on specific accounts, could result in DoS for some services | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on locally |
| 2.2.20 Ensure 'Deny log on through Remote Desktop Services' to include 'Guests' | Same idea as 2.2.19, but from the perspective of a remote connection | Same idea as 2.2.19, but from the perspective of a remote connection | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on through Remote Desktop Services |
| 2.2.21 Ensure 'Enable computer and user accounts to be trusted for delegation' is set to 'No One' | Prevents impersonation by unauthorized users on the network | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Enable computer and user accounts to be trusted for delegation |
| 2.2.22 Ensure 'Force shutdown from a remote system' is set to 'Administrators' | Prevents a mass DoS attack where systems could be routinely, remotely shutdown | Potential disruption of administrative responsibilities | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Force shutdown from a remote system |
| 2.2.23 Ensure 'Generate security audits' is set to 'LOCAL SERVICE, NETWORK SERVICE' | Protect the integrity of security logs while also preventing the mass creation of logs to obfuscate actions | N/A unless running IIS, in which case IIS app pools need this right | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Generate security audits |
| 2.2.24 Ensure 'Impersonate a client after authentication' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE' | Protects against privilege escalation via an unauthorized user using an illicit service to trick a client into authenticating, thus granting them the token needed to impersonate the user | N/A unless running IIS, in which case IIS app pools need this right | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Impersonate a client after authentication |
| 2.2.25 Ensure 'Increase scheduling priority' is set to 'Administrators, Window Manager/Window Manager Group' | Prevents possible DoS attacks via resource exhaustion + prevents possible exploitation of a race condition made possible by resource exhaustion | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Increase scheduling priority |
| 2.2.26 Ensure 'Load and unload device drivers' is set to 'Administrators' | Device drivers run in a privileged mode, thus access to them must be restricted to the highest level of privilege to avoid accidental execution of malicious code | Possible disruption of administrative responsibilities | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Load and unload device drivers |
| 2.2.27 Ensure 'Lock pages in memory' is set to 'No One' | Prevent possible DoS attack via consuming RAM | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Lock pages in memory |
| 2.2.30 Ensure 'Manage auditing and security log' is set to 'Administrators' | Protects the integrity of security logs to preserve evidence in the case of an incident | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Manage auditing and security log |
| 2.2.31 Ensure 'Modify an object label' is set to 'No One' | Prevent users from escalating the privilege level of objects owned by other users, allowing arbitrary code execution | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Modify an object label |
| 2.2.32 Ensure 'Modify firmware environment values' is set to 'Administrators' | Prevent modifications that could affect hardware, leading to DoS condition | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Modify firmware environment values |
| 2.2.33 Ensure 'Perform volume maintenance tasks' is set to 'Administrators' | Protects the integrity of volume storage + prevents DoS condition via storage exhaustion | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Perform volume maintenance tasks |
| 2.2.34 Ensure 'Profile single process' is set to 'Administrators' | Prevents the collection of additional information by unauthorized users that could be used for the weaponization and launching of an attack | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Profile single process |
| 2.2.35 Ensure 'Profile system performance' is set to 'Administrators, NT SERVICE/WdiServiceHost' | Same rationale as 2.2.34 except applied to system processes | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Profile system performance |
| 2.2.36 Ensure 'Replace a process level token' is set to 'LOCAL SERVICE, NETWORK SERVICE' | Prevents users from performing a service as another user, thus obfuscating their actions | N/A unless running IIS, in which case IIS app pools need this right | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Replace a process level token |
| 2.2.37 Ensure 'Restore files and directories' is set to 'Administrators' | Protects the integrity of stored data + prevents possible DoS attack made possible by continuous rollbacks + avoids a possible scenario where an attacker configures a backdoor and is able to continuously rollback to the version of the system with the backdoor set up | Possible disruption of administrative responsibilities (backup operators) | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Restore files and directories |
| 2.2.38 Ensure 'Shut down the system' is set to 'Administrators, Users' | Prevents DoS attack + protects integrity of data | General, but modest disruption in work environment | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Shut down the system |
| 2.2.39 Ensure 'Take ownership of files or other objects' is set to 'Administrators' | Prevents DoS & exposure of sensitive data + protects data integrity | N/A | L1 - Corporate/Enterprise Environment (general use) | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Take ownership of files or other objects |
## Implementing the Policies
Given that a lot of these policies vary based on the user, we won't be modifying the default GPO this time around. Instead, I created a new GPO entitled "Default Workstation" and added the group "Must Be Configured" to the list of groups it applies to.


![Pasted image 20240116150243](https://github.com/Jacob-Hegy/CIS-Hardening-Guide/assets/85857129/98aabcb7-32f2-4be7-93b1-7981eb1132cb)


For the purposes of this project, we are assuming that the new user we created is just your run-of-the-mill employee, no special permissions.

All policies covered in this section fall under the User Rights Assignment section at the file path "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\User Rights Assignment".

![Pasted image 20240116150451](https://github.com/Jacob-Hegy/CIS-Hardening-Guide/assets/85857129/9d11bf66-5c9b-4fbb-a8ed-5769dd81ecf6)

For policies suggesting we grant no one the permission, I'll be enabling the policy and leaving the whitelist blank. Once fully configured, the permissions will look something like this:


![Pasted image 20240116162325](https://github.com/Jacob-Hegy/CIS-Hardening-Guide/assets/85857129/bf3b87b5-4721-40e9-87d1-592938dca5d0)
